function attachEditableRow(n){n.find(".editable-row-toggle").click(function(){var n=$(this),t=n.closest(".editable-row");toggleEditMode(t)});n.find(".editable-row .editable-row-save").click(function(){var i=$(this),n=i.closest(".editable-row"),r=$('input[name="__RequestVerificationToken"]').val(),t={__RequestVerificationToken:r},u="/Admin/"+n.data("controller")+"/"+n.data("action");n.find(".edit-mode-input").each(function(n,i){var r=$(i),u=r.attr("name");t[u]=r.is(":checkbox")?r.is(":checked"):r.val()});$.ajax({url:u,data:t,method:"POST",traditional:!0}).done(function(t){toggleEditMode(n);toastr.success(t.success)}).fail(function(t){toggleEditMode(n);toastr.error(t.status,t.responseText)})});n.find(".editable-row .editable-row-delete").click(function(){var t=$(this),n=t.closest(".editable-row"),i=n.find(".edit-mode-input-key").val(),r=$('input[name="__RequestVerificationToken"]').val(),u={Id:i,__RequestVerificationToken:r},f="/Admin/"+n.data("controller")+"/"+t.data("action");$.ajax({url:f,data:u,method:"POST",traditional:!0}).done(function(t){n.fadeOut();toastr.success(t.success)}).fail(function(n){toastr.error(n.status,n.responseText)})})}function toggleEditMode(n){n.hasClass("read-mode")?(n.find(".edit-mode-only").removeClass("hidden"),n.find(".read-mode-only").addClass("hidden"),n.find(".edit-mode-input").attr("disabled",!1),n.removeClass("read-mode").addClass("edit-mode")):(n.find(".edit-mode-only").addClass("hidden"),n.find(".read-mode-only").removeClass("hidden"),n.find(".edit-mode-input").attr("disabled","disabled"),n.removeClass("edit-mode").addClass("read-mode"))}$(function(){"use strict";$(".mvc-grid").mvcgrid();toastr.options.closeButton=!0});$(function(){attachEditableRow($("body"))});$(function(){$.fn.mvcgrid.lang={Text:{Contains:"Съдържа",Equals:"Равно на",NotEquals:"Различно от",StartsWith:"Започва с",EndsWith:"Завършва на"},Number:{Equals:"Равно на",NotEquals:"Различно от",LessThan:"По-малко от",GreaterThan:"По-голямо от",LessThanOrEqual:"По-малко или равно",GreaterThanOrEqual:"По-голямо или равно"},Date:{Equals:"Равна на",NotEquals:"Различна от",LessThan:"По малка от",GreaterThan:"По-голяма от",LessThanOrEqual:"По-малка или равна",GreaterThanOrEqual:"По-голяма или равна"},Boolean:{Yes:"Да",No:"Не"},Filter:{Apply:"✔",Remove:"✘"},Operator:{Select:"",And:"И",Or:"Или"}}});$(function(){$("#blog-image-selection").change(function(){for(var i=new FormData,n=$(this),r=n.get(0).files,f=n.data("id"),u=$(n.data("target")),e=n.val(),t=0;t<r.length;t++)i.append(r[t].name,r[t]);f!==undefined&&i.append("blogPostId",f);$.ajax({data:i,contentType:!1,processData:!1,type:"POST",url:"/Admin/Images/UploadBlogPostMainImage"}).done(function(t){for(var o,i=0;i<t.length;i++){var s=t[i].relativePath,h=t[i].id,r=$('<img class="img-fluid"  src="'+s+'" />'),f=$('<input type="hidden" name="ThumbImageId"/>'),e=$('<input type="hidden" name="ImageUrl"/>');n.val()&&(o=n.val().substr(n.val().lastIndexOf("\\")+1),n.closest(".file-selection-container").find(".file-selection-label").html(o));e.val(t[i].relativePath);f.val(h);u.html(f);r.hide();u.append(r);u.append(e);r.fadeIn()}}).fail(function(n){console.log(n)})})});$(function(){$(".add-paragrpaph-btn").click(function(){var n=$("#Id").val(),t=$('input[name="__RequestVerificationToken"]').val(),i={blogId:n,__RequestVerificationToken:t};$.ajax({url:"/Admin/BlogPosts/CreateParagraph",method:"POST",data:i,traditional:!0}).done(function(n){var t=$(n);attachEditableRow(t);$("#paragraphs-wrapper").append(t)}).fail(function(n){toastr.error(n.status,n.responseText)})});var n=$(".paragraph #Text");n.length>0&&CKEDITOR.replace("Text")});$(function(){function n(n,t){var i=$('input[name="__RequestVerificationToken"]').val(),r={categoryId:n,positionDelta:t,__RequestVerificationToken:i};$.ajax({data:r,url:"/Admin/ProductCategories/ChangePosition",traditional:!0,method:"POST"}).done(function(){}).fail(function(n){toastr.error(n.status,n.responseText+"! Презареди страницата!")})}$(".sortable-categories").sortable({containerSelector:"div.sortable,ol,ul",itemSelector:"div.row, li",pullPlaceholder:!1,handle:"i.fa-arrows",onDrop:function(t,i,r,u){r(t,i,r,u);var f=t.data("index")-t.data("old-index"),e=t.data("id");$(".category-item").each(function(n,t){$(t).find(".position").text(n)});n(e,f)}})});$(function(){$("#thumb-image-selection").change(function(){for(var u=new FormData,n=$(this),i=n.get(0).files,r=$(n.data("target")),f=n.val(),t=0;t<i.length;t++)u.append(i[t].name,i[t]);$.ajax({data:u,contentType:!1,processData:!1,type:"POST",url:"/Admin/Images/UploadProductImage"}).done(function(t){for(var o,i=0;i<t.length;i++){var s=t[i].relativePath,h=t[i].id,u=$('<img class="img-fluid"  src="'+s+'" />'),f=$('<input type="hidden" name="ThumbImageId"/>'),e=$('<input type="hidden" name="ImageUrl"/>');n.val()&&(o=n.val().substr(n.val().lastIndexOf("\\")+1),n.closest(".file-selection-container").find(".file-selection-label").html(o));e.val(t[i].relativePath);f.val(h);r.html(f);u.hide();r.append(u);r.append(e);u.fadeIn()}}).fail(function(n){console.log(n)})})});$(function(){function n(n){var t=n.data("image-id"),i=$("#Id").val(),r=$('input[name="__RequestVerificationToken"]').val(),u={productId:i,imageId:t,__RequestVerificationToken:r};$.ajax({data:u,traditional:!0,type:"POST",url:"/Admin/Images/DeleteProductImage"}).done(function(t){var i=n.closest(".carousel-item");i.closest(".carousel").carousel("next");setTimeout(function(){i.remove()},1500);toastr.success(t.success)}).fail(function(n){toastr.error(n.status,n.responseText)})}$("#Description").length>0&&CKEDITOR.replace("Description");$(".delete-gallery-image-btn").click(function(t){t.preventDefault();n($(this))});$("#thumb-image-upload").change(function(){for(var r=$(this),t=r.get(0).files,u=$("#Id").val(),i=new FormData,n=0;n<t.length;n++)i.append(t[n].name,t[n]);i.append("productId",u);$.ajax({data:i,contentType:!1,processData:!1,type:"POST",url:"/Admin/Images/UploadProductMainImage"}).done(function(n){for(var t=$("#thumb-image-preview"),i=0;i<n.length;i++){t.fadeOut();var u=n[i].relativePath,f=n[i].id,r=n[i].name,e=t.find(".thumb-image"),o=t.find("#ThumbImage_Id"),s=t.find("#ThumbImage_Path"),h=t.find("#ThumbImage_Name");s.val(n[i].relativePath);o.val(f);h.val(r);e.attr("src",u).attr("alt",r);t.fadeIn()}}).fail(function(n){toastr.error(n.status,n.responseText)})});$("#galery-image-upload").change(function(){var f=$(this),i=f.get(0).files,e=$("#Id").val(),r=new FormData,t,u;for(r.append("productId",e),t=0;t<i.length;t++)r.append(i[t].name,i[t]);u=$('<div class="carousel-item"> <img class="d-block w-100" src="" alt= "" ><a class="btn btn-danger btn-sm pull-righ delete-gallery-image-btn" data-image-id=""><i class="fa fa-trash"><\/i><\/a><\/div>');$.ajax({data:r,contentType:!1,processData:!1,type:"POST",url:"/Admin/Images/UploadProductGaleryImages"}).done(function(t){var i;for(console.log(t),i=0;i<t.length;i++){var r=u.clone(),f=$(".carousel-inner"),e=r.find(".delete-gallery-image-btn");r.find("img").attr("src",t[i].relativePath).attr("alt",t[i].name);f.find(".carousel-item").length===0&&r.addClass("active");e.data("image-id",t[i].id);e.click(function(t){t.preventDefault();n($(this))});f.append(r)}toastr.success("Kaчването е успешно")}).fail(function(n){toastr.error(n.status,n.responseText)})})});
//# sourceMappingURL=admin.min.js.map